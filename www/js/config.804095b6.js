webpackJsonp([20],{"/ld9":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(t[l]=a[l])}return t},s=a("NYxO");e.default={data:function(){return{remoteData:"",bCommitting:!1,HTTPPort:0,HTTPWanPort:"",RTMPWanPort:"",ServerWanIP:"",allowCaptcha:!1,apiAuthed:!1,playAuthed:!1,loginAuthed:!1,allows:"",notallows:"",loginUrl:"",externalIp:"",activeName:"sysconfig",refreshplaytokenID:"",https:!1,httpsPort:0,httpsCertFile:"",httpsKeyFile:"",allowVOD:!1,allowScreen:!0,streamAuthUrl:""}},mounted:function(){this.updateData()},methods:l({},(0,s.mapActions)(["getServerInfo"]),{handleClick:function(e,a){t("#tab-"+e.$options.propsData.name).blur()},refreshplaytoken:function(){var e=this;this.$confirm(""+this.$t("m.config_refresh_msg"),this.$t("m.c_prompt")).then(function(){t.post("api/v1/refreshplaytoken",{id:e.refreshplaytokenID}).then(function(t){e.$message({type:"success",message:e.$t("m.config_refresh_token_msg")})})}).catch(function(){})},updateData:function(){var e=this;t.post("api/v1/conf/getbaseconfig",{type:"sys"}).then(function(t){var a=t.data;e.ServerWanIP=a.ServerWanIP,e.HTTPPort=a.HTTPPort,e.HTTPWanPort=a.HTTPWanPort,e.RTMPWanPort=a.RTMPWanPort,e.allows=a.allows,e.apiAuthed=a.apiAuthed,e.allowCaptcha=a.allowCaptcha,e.playAuthed=a.playAuthed,e.loginAuthed=a.loginAuthed,e.externalIp=a.externalIp,e.https=a.https,e.httpsPort=a.httpsPort,e.httpsCertFile=a.httpsCertFile,e.httpsKeyFile=a.httpsKeyFile,e.allowVOD=a.allowVOD,e.allowScreen=a.allowScreen,e.notallows=a.notallows,e.loginUrl=a.loginUrl,e.streamAuthUrl=a.streamAuthUrl,e.remoteData=JSON.stringify(e.getCommitObject())})},save:function(){var e=this;this.bCommitting=!0;var a=JSON.parse(this.remoteData).HTTPPort,l=this.getCommitObject().HTTPPort;""!=this.externalIp&&-1!=this.externalIp.indexOf("://")&&(this.externalIp=this.externalIp.split("://")[1]),""!=this.loginUrl&&-1!=this.loginUrl.indexOf("://")&&(this.loginUrl=this.loginUrl.split("://")[1]),t.post("api/v1/conf/savebaseconfig",this.getCommitObject()).then(function(){a!=l?(e.$message({type:"success",message:e.$t("m.config_modify_msg1")+"["+a+"]"+e.$t("m.config_modify_msg2")+l+e.$t("m.config_modify_msg3")}),setTimeout(function(){var t=80==l?"":":"+l;window.location.href=location.protocol+"//"+location.hostname+t+"/#/config"},3e3)):e.$message({type:"success",message:e.$t("m.config_save_msg")})}).always(function(){e.updateData(),e.bCommitting=!1,e.getServerInfo()})},getCommitObject:function(){return{HTTPPort:this.HTTPPort,rtmpPort:this.RTMPWanPort,allows:this.allows,apiAuthed:this.apiAuthed,allowCaptcha:this.allowCaptcha,playAuthed:this.playAuthed,loginAuthed:this.loginAuthed,externalIp:this.externalIp,ServerWanIP:this.ServerWanIP,allowVOD:this.allowVOD,allowScreen:this.allowScreen,https:this.https,httpsPort:this.httpsPort,httpsCertFile:this.httpsCertFile,httpsKeyFile:this.httpsKeyFile,notallows:this.notallows,loginUrl:this.loginUrl,streamAuthUrl:this.streamAuthUrl}}}),computed:l({},(0,s.mapState)(["serverInfo"]),{isNoChange:function(){var t=JSON.stringify(this.getCommitObject());return 0==this.remoteData.localeCompare(t)}})}}).call(e,a("0iPh"))},"/xmJ":function(t,e,a){var l=a("AQd1");"string"==typeof l&&(l=[[t.i,l,""]]),l.locals&&(t.exports=l.locals);a("rjj0")("5dc55a8c",l,!0,{})},AQd1:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"input[name=HTTPPort],input[name=httpsPort],input[name=RTMPWanPort]{text-align:left!important}.prompt{color:#009551}",""])},kfdp:function(t,e,a){"use strict";var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"qcontent-header"},[t._v("系统配置 ")]),t._v(" "),a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"box no-border"},[a("div",{staticClass:"box-body"},[a("form",{staticClass:"form-horizontal",attrs:{role:"form"}},[[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基础配置",name:"sysconfig"}},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.ServerWanIP,expression:"ServerWanIP",modifiers:{trim:!0}}],attrs:{type:"hidden",name:"ServerWanIP"},domProps:{value:t.ServerWanIP},on:{input:function(e){e.target.composing||(t.ServerWanIP=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"channel-snap-interval"}},[t._v(t._s(t.$t("m.config_server_ip")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("span",{staticClass:"help-block",staticStyle:{"margin-top":"9px",color:"black"}},[t._v(t._s(t.ServerWanIP))])])]),t._v(" "),a("div",{class:{"form-group":!0,"has-error":t.errors.has("externalIp")},attrs:{title:t.$t("m.config_cluster_external_ip_msg")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-external-ip"}},[t._v(t._s(t.$t("m.config_cluster_external_ip")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"validate",rawName:"v-validate",value:"url",expression:"'url'"},{name:"model",rawName:"v-model.trim",value:t.externalIp,expression:"externalIp",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"externalIp","data-vv-as":t.$t("m.config_cluster_external_ip"),placeholder:t.$t("m.config_cluster_external_ip_title")},domProps:{value:t.externalIp},on:{input:function(e){e.target.composing||(t.externalIp=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("span",{staticClass:"help-block"},[t._v(t._s(t.errors.first("externalIp")))])])]),t._v(" "),a("div",{class:{"form-group":!0,"has-error":t.errors.has("HTTPPort")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-node-port"}},[t._v(t._s(t.$t("m.config_http_port")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-input-number",{staticStyle:{"margin-top":"5px"},attrs:{min:0,max:65535,size:"small",controls:!1,name:"HTTPPort"},model:{value:t.HTTPPort,callback:function(e){t.HTTPPort=e},expression:"HTTPPort"}}),t._v(" "),a("span",{staticClass:"help-block"},[t._v(t._s(t.errors.first("RTMPWanPort")))])],1)]),t._v(" "),a("div",{staticClass:"form-group hide"},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"channel-snap-interval"}},[t._v(t._s(t.$t("m.config_http_port")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{staticClass:"form-control",attrs:{type:"text",id:"HTTPWanPort",spellcheck:"false",name:"HTTPWanPort","data-vv-as":t.$t("m.config_http_port")},domProps:{value:t.HTTPWanPort}}),t._v(" "),a("span",{staticClass:"help-block"})])]),t._v(" "),a("div",{class:{"form-group":!0,"has-error":t.errors.has("RTMPWanPort")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-rtmp-port"}},[t._v(t._s(t.$t("m.config_rtmp_port")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-input-number",{staticStyle:{"margin-top":"5px"},attrs:{min:0,max:65535,size:"small",controls:!1,name:"RTMPWanPort"},model:{value:t.RTMPWanPort,callback:function(e){t.RTMPWanPort=e},expression:"RTMPWanPort"}}),t._v(" "),a("span",{staticClass:"help-block"},[t._v(t._s(t.errors.first("RTMPWanPort")))])],1)]),t._v(" "),3!=this.serverInfo.ProductType?a("div",{staticClass:"form-group",attrs:{title:"是否开启云视频服务"}},[a("label",{staticClass:"col-md-3 control-label"},[t._v("云视频服务")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-switch",{staticStyle:{"margin-top":"6px"},attrs:{"active-text":t.$t("m.c_open"),"inactive-text":t.$t("m.c_close")},model:{value:t.allowVOD,callback:function(e){t.allowVOD=e},expression:"allowVOD"}})],1)]):t._e(),t._v(" "),a("div",{staticClass:"form-group",attrs:{title:"是否开启分屏展示"}},[a("label",{staticClass:"col-md-3 control-label"},[t._v("分屏展示")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-switch",{staticStyle:{"margin-top":"6px"},attrs:{"active-text":t.$t("m.c_open"),"inactive-text":t.$t("m.c_close")},model:{value:t.allowScreen,callback:function(e){t.allowScreen=e},expression:"allowScreen"}})],1)]),t._v(" "),a("div",{staticClass:"form-group",attrs:{title:"是否开启HTTPS服务"}},[a("label",{staticClass:"col-md-3 control-label"},[t._v("HTTPS服务")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-switch",{staticStyle:{"margin-top":"6px"},attrs:{"active-text":t.$t("m.c_open"),"inactive-text":t.$t("m.c_close")},model:{value:t.https,callback:function(e){t.https=e},expression:"https"}})],1)]),t._v(" "),t.https?a("div",{class:{"form-group":!0,"has-error":t.errors.has("httpsPort")}},[a("label",{staticClass:"col-md-3 control-label"},[t._v("HTTPS端口")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-input-number",{staticStyle:{"margin-top":"5px"},attrs:{min:0,max:65535,size:"small",controls:!1,name:"httpsPort"},model:{value:t.httpsPort,callback:function(e){t.httpsPort=e},expression:"httpsPort"}}),t._v(" "),a("span",{staticClass:"help-block"},[t._v(t._s(t.errors.first("httpsPort")))])],1)]):t._e(),t._v(" "),t.https?a("div",{class:{"form-group":!0,"has-error":t.errors.has("httpsCertFile")},attrs:{title:"配置Cert证书路径，绝对路径"}},[a("label",{staticClass:"col-md-3 control-label"},[t._v("HTTPS Cert证书路径")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.httpsCertFile,expression:"httpsCertFile",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"httpsCertFile",placeholder:"配置cert证书路径"},domProps:{value:t.httpsCertFile},on:{input:function(e){e.target.composing||(t.httpsCertFile=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("span",{staticClass:"help-block"},[t._v(t._s(t.errors.first("httpsCertFile")))])])]):t._e(),t._v(" "),t.https?a("div",{class:{"form-group":!0,"has-error":t.errors.has("httpsKeyFile")},attrs:{title:"配置Cert证书路径，绝对路径"}},[a("label",{staticClass:"col-md-3 control-label"},[t._v("HTTPS Key证书路径")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.httpsKeyFile,expression:"httpsKeyFile",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"httpsKeyFile",placeholder:"配置key证书路径"},domProps:{value:t.httpsKeyFile},on:{input:function(e){e.target.composing||(t.httpsKeyFile=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("span",{staticClass:"help-block"},[t._v(t._s(t.errors.first("httpsKeyFile")))])])]):t._e()]),t._v(" "),a("el-tab-pane",{attrs:{label:"安全配置",name:"securityconfig"}},[a("div",{staticClass:"form-group",attrs:{title:t.$t("m.config_api_auth_title")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-api-authed"}},[t._v(t._s(t.$t("m.config_api_auth")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-switch",{staticStyle:{"margin-top":"6px"},attrs:{"active-text":t.$t("m.c_open"),"inactive-text":t.$t("m.c_close")},model:{value:t.apiAuthed,callback:function(e){t.apiAuthed=e},expression:"apiAuthed"}})],1)]),t._v(" "),a("div",{staticClass:"form-group",attrs:{title:t.$t("m.config_login_graphic_verification_title")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-allow-captcha"}},[t._v(t._s(t.$t("m.config_login_graphic_verification")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-switch",{staticStyle:{"margin-top":"6px"},attrs:{"active-text":t.$t("m.c_open"),"inactive-text":t.$t("m.c_close")},model:{value:t.allowCaptcha,callback:function(e){t.allowCaptcha=e},expression:"allowCaptcha"}})],1)]),t._v(" "),a("div",{staticClass:"form-group",attrs:{title:t.$t("m.config_login_auth_prompt")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-loginAuthed"}},[t._v(t._s(t.$t("m.config_login_auth")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-switch",{staticStyle:{"margin-top":"6px"},attrs:{"active-text":t.$t("m.c_open"),"inactive-text":t.$t("m.c_close")},model:{value:t.loginAuthed,callback:function(e){t.loginAuthed=e},expression:"loginAuthed"}})],1)]),t._v(" "),a("div",{staticClass:"form-group",attrs:{title:t.$t("m.config_play_auth_title")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-playAuthed"}},[t._v(t._s(t.$t("m.config_play_auth")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("el-switch",{staticStyle:{"margin-top":"6px"},attrs:{"active-text":t.$t("m.c_open"),"inactive-text":t.$t("m.c_close")},model:{value:t.playAuthed,callback:function(e){t.playAuthed=e},expression:"playAuthed"}})],1)]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.playAuthed,expression:"playAuthed"}],staticClass:"form-group",attrs:{title:t.$t("m.config_play_auth_token_title")}},[a("label",{staticClass:"col-md-3 control-label",attrs:{for:"input-playAuthed"}},[t._v(t._s(t.$t("m.config_play_auth_token")))]),t._v(" "),a("div",{staticClass:"col-md-3"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.refreshplaytokenID,expression:"refreshplaytokenID",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"refreshplaytokenID",placeholder:t.$t("m.config_play_auth_token_msg")},domProps:{value:t.refreshplaytokenID},on:{input:function(e){e.target.composing||(t.refreshplaytokenID=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),a("div",{staticClass:"col-md-4"},[a("button",{staticClass:"btn  btn-default",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.refreshplaytoken(e)}}},[a("i",{staticClass:"fa fa-repeat"}),t._v(" "+t._s(t.$t("m.config_play_auth_token_refresh")))])])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-md-3 control-label"},[t._v("播放回调鉴权")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.streamAuthUrl,expression:"streamAuthUrl",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"streamAuthUrl",placeholder:"播放时回调鉴权的接口地址"},domProps:{value:t.streamAuthUrl},on:{input:function(e){e.target.composing||(t.streamAuthUrl=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("div",{staticClass:"help-block"},[t._v("播放鉴权第三方回调地址, 服务相关鉴权通过后再回调, HTTP GET, 请求参数(透传流地址参数, app, call, name, addr), 响应(200 - 鉴权通过, 其它 - 鉴权不通过)")])])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-md-3 control-label"},[t._v(t._s(t.$t("m.config_anti_stealing_link")))]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.allows,expression:"allows",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"allows",placeholder:"yourdomain[,*.baidu.com][,*.google.com]"},domProps:{value:t.allows},on:{input:function(e){e.target.composing||(t.allows=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("div",{staticClass:"help-block"},[t._v(t._s(t.$t("m.config_anti_stealing_link_title")))])])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-md-3 control-label"},[t._v("防盗链配置（黑名单）")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.notallows,expression:"notallows",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"notallows",placeholder:"yourdomain[,*.baidu.com][,*.google.com]"},domProps:{value:t.notallows},on:{input:function(e){e.target.composing||(t.notallows=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("div",{staticClass:"help-block"},[t._v('HTTP(S)请求资源时, 不允许访问的域名, 多个域名用逗号 "," 间隔, 不填表示不启用防盗链的 黑名单 功能')])])]),t._v(" "),a("div",{staticClass:"form-group"},[a("label",{staticClass:"col-md-3 control-label"},[t._v("接口页面访问限制")]),t._v(" "),a("div",{staticClass:"col-md-7"},[a("input",{directives:[{name:"validate",rawName:"v-validate",value:"url",expression:"'url'"},{name:"model",rawName:"v-model.trim",value:t.loginUrl,expression:"loginUrl",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",spellcheck:"false",autocomplete:"off",name:"loginUrl","data-vv-as":"接口页面访问限制",placeholder:"yourdomain"},domProps:{value:t.loginUrl},on:{input:function(e){e.target.composing||(t.loginUrl=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),a("div",{staticClass:"help-block"},[t._v("HTTP(S)请求接口页面时, 强制使用该 域名|IP 才能访问, 不填表示不启用 接口页面访问限制 功能")]),t._v(" "),a("span",{staticClass:"help-block",staticStyle:{color:"red"}},[t._v(t._s(t.errors.first("loginUrl")))])])])])],1)]],2)]),t._v(" "),a("div",{staticClass:"box-footer clearfix text-center"},[a("button",{staticClass:"btn btn-success",attrs:{type:"button",disabled:t.isNoChange||t.errors.count()>0||t.bCommitting},on:{click:function(e){return e.preventDefault(),t.save(e)}}},[a("i",{staticClass:"fa fa-save"}),t._v("  "+t._s(t.bCommitting?"提交中...":t.$t("m.config_save")))])])])])])},s=[],o={render:l,staticRenderFns:s};e.a=o},"o9Q+":function(t,e,a){"use strict";function l(t){a("/xmJ")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("/ld9"),o=a.n(s);for(var r in s)["default","default"].indexOf(r)<0&&function(t){a.d(e,t,function(){return s[t]})}(r);var i=a("kfdp"),n=a("VU/8"),c=l,p=n(o.a,i.a,!1,c,null,null);e.default=p.exports}});