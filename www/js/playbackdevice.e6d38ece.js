webpackJsonp([23],{"6Ydy":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r("ecks"),n=r.n(a);for(var s in a)["default","default"].indexOf(s)<0&&function(t){r.d(e,t,function(){return a[t]})}(s);var i=r("msgK"),o=r("VU/8"),u=o(n.a,i.a,!1,null,null,null);e.default=u.exports},ecks:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function n(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,r){function a(n,s){try{var i=e[n](s),o=i.value}catch(t){return void r(t)}if(!i.done)return Promise.resolve(o).then(function(t){a("next",t)},function(t){a("throw",t)});t(o)}return a("next")})}}Object.defineProperty(e,"__esModule",{value:!0});var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},i=r("I3G/"),o=(a(i),r("NYxO")),u=r("0iPh"),c=a(u),l=r("PJh5");a(l);e.default={props:{page:{type:Number,default:1},q:{type:String,default:""}},data:function(){return{pageSize:10,query:"",pageData:[],total:0,sort:"name",order:"ascending"}},mounted:function(){this.query=this.q,this.$refs.search.focus(),this.$emit("setTitle",this.$t("m.record_device_list")),this.load()},computed:s({},(0,o.mapState)(["userInfo"])),methods:{changePage:function(t){this.$router.push("/playback/"+t)},load:function(){var t=this;c.default.post("api/v1/record/query_devices",{start:(this.page-1)*this.pageSize,limit:this.pageSize,q:this.query,sort:this.sort,order:this.order}).then(function(e){var r=e.data;t.pageData=r.rows,t.total=r.total})},sortChange:function(t){this.sort=t.prop,this.order=t.order,this.load()},selectDevice:function(t){this.$emit("select-device",t)},doSearch:function(){this.page=1,this.$router.push("/playback/"+this.page+(this.query?"?q="+this.query:""))},remove:function(t){var e=this;return n(regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:e.$confirm(e.$t("m.c_delete_ensure")+" "+t.name+" "+e.$t("m.record_device_delete_msg"),e.$t("m.c_prompt")).then(function(){c.default.post("api/v1/record/remove_device",{id:t.id}).always(function(){e.load()})}).catch(function(){});case 1:case"end":return r.stop()}},r,e)}))()}},beforeRouteEnter:function(t,e,r){return t.params.page?(t.params.page=parseInt(t.params.page)||1,t.params.q=t.query.q,r()):r({path:"/playback/1",replace:!0})},beforeRouteUpdate:function(t,e,r){var a=this;if(!t.params.page)return r({path:"/playback/1",replace:!0});t.params.page=parseInt(t.params.page)||1,t.params.q=t.query.q,r(),this.$nextTick(function(){a.query=a.q,a.load()})}}},msgK:function(t,e,r){"use strict";var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"box box-success ids"},[r("div",{staticClass:"box-header"},[r("div",{staticClass:"form-inline"},[r("div",{staticClass:"form-group pull-right"},[r("div",{staticClass:"input-group"},[r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.query,expression:"query",modifiers:{trim:!0}}],ref:"search",staticClass:"form-control",attrs:{type:"text",placeholder:t.$t("m.c_search")},domProps:{value:t.query},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.doSearch(e)},input:function(e){e.target.composing||(t.query=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),t._v(" "),r("div",{staticClass:"input-group-btn"},[r("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.doSearch(e)}}},[r("i",{staticClass:"fa fa-search"})])])])])])]),t._v(" "),r("div",{staticClass:"box-body"},[r("el-table",{attrs:{data:t.pageData,stripe:"","default-sort":{prop:"name",order:"ascending"}},on:{"sort-change":t.sortChange}},[t.userInfo.admin?r("el-table-column",{attrs:{"min-width":"180",label:"ID",prop:"id","show-overflow-tooltip":"",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                    "+t._s(e.row.id)+"\r\n                ")]}}],null,!1,3266350224)}):t._e(),t._v(" "),r("el-table-column",{attrs:{"min-width":"180",label:t.$t("m.c_name"),prop:"name","show-overflow-tooltip":"",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n                    "+t._s(e.row.name)+"\r\n                ")]}}])}),t._v(" "),r("el-table-column",{attrs:{"min-width":"100",label:t.$t("m.c_snap")},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-popover",{attrs:{placement:"top-start",title:e.row.id,width:"345",trigger:"hover",content:""}},[r("img",{staticStyle:{height:"240px",width:"320px"},attrs:{onerror:'this.src="images/snap.png"',src:"api/v1/record/getsnap?id="+e.row.id+"&range=1800"}}),t._v(" "),r("img",{staticStyle:{height:"30px",width:"50px"},attrs:{slot:"reference",onerror:'this.src="images/snap.png"',src:"api/v1/record/getsnap?id="+e.row.id+"&range=1800"},slot:"reference"})])]}}])}),t._v(" "),r("el-table-column",{attrs:{label:t.$t("m.c_operate"),"min-width":t.userInfo.admin?200:100,fixed:!t.isMobile()&&"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"btn-group"},[r("router-link",{staticClass:"btn btn-success btn-xs",attrs:{to:"/playback/timeview/"+e.row.id}},[r("i",{staticClass:"fa fa-file-video-o"}),t._v(" "+t._s(t.$t("m.record_query"))+"\r\n                        ")]),t._v(" "),t.userInfo.admin?r("a",{staticClass:"btn btn-danger btn-xs",attrs:{role:"button"},on:{click:function(r){return r.preventDefault(),t.remove(e.row)}}},[r("i",{staticClass:"fa fa-remove"}),t._v(" "+t._s(t.$t("m.c_delete"))+"\r\n                        ")]):t._e()],1)]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"updateAt","min-width":"200",label:t.$t("m.c_updatetime"),sortable:"custom"}})],1)],1),t._v(" "),r("div",{staticClass:"box-footer clearfix"},[r("el-pagination",{staticClass:"pull-right",attrs:{layout:"prev,pager,next,jumper",total:t.total,"page-size":t.pageSize,"current-page":t.page},on:{"update:pageSize":function(e){t.pageSize=e},"update:page-size":function(e){t.pageSize=e},"current-change":t.changePage}})],1)])},n=[],s={render:a,staticRenderFns:n};e.a=s}});